
<h1 class="sectionedit1" id="installation">Installation</h1>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Installation&quot;,&quot;hid&quot;:&quot;installation&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-28&quot;} -->
<h2 class="sectionedit2" id="environment_preparation">Environment Preparation</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> Gain system access:</p><pre class='cli  '><span class="cli_prompt">&gt; </span><span class="cli_command">root</span>
<span class="cli_prompt">&gt; </span><span class="cli_command">voidlinux</span>
<span class="cli_prompt"># </span><span class="cli_command">bash</span></pre><p></div>
</li>
<li class="level1"><div class="li"> Set console keymap and font:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">loadkeys us</span>
<span class="cli_prompt"># </span><span class="cli_command">setfont eurlatgr</span>
<span class="cli_prompt"># </span><span class="cli_command">unicode_start</span></pre><p></div>
</li>
<li class="level1"><div class="li">  Disable system beeping (pcspkr module):</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">modprobe -r pcspkr</span></pre><p></div>
</li>
<li class="level1"><div class="li"> Verify UEFI boot and mount efivars as read-only to protect UEFI NVRAM:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">ls -ld /sys/firmware/efi/</span>
<span class="cli_prompt"># </span><span class="cli_command">mount -t efivarfs -o ro efivarfs /sys/firmware/efi/efivars/</span></pre><p></div>
</li>
<li class="level1"><div class="li"> Verify internet connectivity. See <a href="http://localhost/void/network" class="wikilink2" title="void:network" rel="nofollow" data-wiki-id="void:network">Network</a>.</div>
</li>
<li class="level1"><div class="li"> Update live environment system and install additional packages:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">xbps-install -Su xbps &amp;&amp; xbps-install -Su</span>
<span class="cli_prompt"># </span><span class="cli_command">xbps-install parted</span></pre><p></div>
</li>
</ol>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Environment Preparation&quot;,&quot;hid&quot;:&quot;environment_preparation&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;29-687&quot;} -->
<h2 class="sectionedit3" id="disk_partitioning">Disk Partitioning</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> Create partitions:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">cfdisk -z &lt;/dev/sdX&gt;</span>
<span class="cli_prompt">cfdisk&gt; </span><span class="cli_command">gpt</span>
<span class="cli_prompt">cfdisk&gt; </span><span class="cli_command">n</span>
<span class="cli_prompt">cfdisk&gt; </span><span class="cli_command">2GiB</span>
<span class="cli_prompt">cfdisk&gt; </span><span class="cli_command">t</span>
<span class="cli_prompt">cfdisk&gt; </span><span class="cli_command">EFI System</span>
<span class="cli_prompt">cfdisk&gt; </span><span class="cli_command">n</span>
<span class="cli_prompt">cfdisk&gt; </span><span class="cli_command"> (Enter)</span>
<span class="cli_prompt">cfdisk&gt; </span><span class="cli_command">W</span>
<span class="cli_prompt">cfdisk&gt; </span><span class="cli_command">yes</span>
<span class="cli_prompt">cfdisk&gt; </span><span class="cli_command">q</span>
<span class="cli_prompt"># </span><span class="cli_command">parted -s &lt;/dev/sdX&gt; name 1 ESP</span>
<span class="cli_prompt"># </span><span class="cli_command">parted -s &lt;/dev/sdX&gt; name 2 LUKS</span></pre><p></div>
</li>
<li class="level1 node"><div class="li"> Create filesystems: </div>
<ol>
<li class="level2"><div class="li"> EFI filesystem:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">wipefs -a &lt;/dev/sdX1&gt;</span>
<span class="cli_prompt"># </span><span class="cli_command">mkfs.vfat -F 32 &lt;/dev/sdX1&gt;</span>
<span class="cli_prompt"># </span><span class="cli_command">fatlabel &lt;/dev/sdX1&gt; ESP</span>
<span class="cli_prompt"># </span><span class="cli_command">fatlabel -i &lt;/dev/sdX1&gt; 00000001</span>
<span class="cli_prompt"># </span><span class="cli_command">fsck.vfat &lt;/dev/sdX1&gt; ; echo $?</span></pre><p></div>
</li>
<li class="level2"><div class="li"> LUKS encrypted filesystem:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">dd if=/dev/urandom of=&lt;/dev/sdX2&gt; status=progress ; sync</span>
<span class="cli_prompt"># </span><span class="cli_command">wipefs -a &lt;/dev/sdX2&gt;</span>
<span class="cli_prompt"># </span><span class="cli_command">cryptsetup luksFormat -y --type luks2 &lt;/dev/sdX2&gt;</span>
<span class="cli_prompt">&gt; </span><span class="cli_command">YES</span>
<span class="cli_prompt">&gt; </span><span class="cli_command">&lt;NEW_LUKS_PASSWORD&gt;</span>
<span class="cli_prompt">&gt; </span><span class="cli_command">&lt;NEW_LUKS_PASSWORD (VERIFY)&gt;</span>
<span class="cli_prompt"># </span><span class="cli_command">cryptsetup config --label LUKS &lt;/dev/sdX2&gt;</span>
<span class="cli_prompt"># </span><span class="cli_command">cryptsetup luksUUID --uuid 00000000-0000-0000-0000-000000000002 &lt;/dev/sdX2&gt;</span>
<span class="cli_prompt">&gt; </span><span class="cli_command">YES</span>
<span class="cli_prompt"># </span><span class="cli_command">cryptsetup open --type luks2 &lt;/dev/sdX2&gt; luks-root</span>
<span class="cli_prompt">&gt; </span><span class="cli_command">&lt;LUKS_PASSWORD&gt;</span></pre><p></div>
</li>
<li class="level2"><div class="li"> Root filesystem:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">wipefs -a /dev/mapper/luks-root</span>
<span class="cli_prompt"># </span><span class="cli_command">mkfs.btrfs /dev/mapper/luks-root</span>
<span class="cli_prompt"># </span><span class="cli_command">btrfs filesystem label /dev/mapper/luks-root LUKS-ROOT</span>
<span class="cli_prompt"># </span><span class="cli_command">btrfstune -U 00000000-0000-0000-0000-000000000003 /dev/mapper/luks-root</span>
<span class="cli_prompt">&gt; </span><span class="cli_command">y</span>
<span class="cli_prompt"># </span><span class="cli_command">btrfs check /dev/mapper/luks-root ; echo $?</span></pre><p></div>
</li>
</ol>
</li>
<li class="level1"><div class="li"> Verify partitions and filesystems:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">parted -s &lt;/dev/sdX&gt; [unit B] p free</span>
<span class="cli_prompt"># </span><span class="cli_command">lsblk -fp &lt;/dev/sdX&gt;</span></pre><p></div>
</li>
</ol>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Disk Partitioning&quot;,&quot;hid&quot;:&quot;disk_partitioning&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;688-2015&quot;} -->
<h2 class="sectionedit4" id="base_system_installation">Base System Installation</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> Create mount points and mount filesystems:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">mkdir -p /mnt/void/</span>
<span class="cli_prompt"># </span><span class="cli_command">mount /dev/mapper/luks-root /mnt/void/</span>
<span class="cli_prompt"># </span><span class="cli_command">mkdir -p /mnt/void/boot/</span>
<span class="cli_prompt"># </span><span class="cli_command">mount &lt;/dev/sdX1&gt; /mnt/void/boot/</span></pre><p></div>
</li>
<li class="level1"><div class="li"> Copy xbps signing keys:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">mkdir -p /mnt/void/var/db/xbps/keys/</span>
<span class="cli_prompt"># </span><span class="cli_command">xbps-query -f xbps | grep &#039;/var/db/xbps/keys/&#039; | xargs -I {} cp {} /mnt/void/var/db/xbps/keys/</span></pre><p></div>
</li>
<li class="level1"><div class="li"> Instal minimal base system packages:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">xbps-install -S -R https://repo-default.voidlinux.org/current -r /mnt/void/ base-minimal</span></pre><p></div>
</li>
</ol>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Base System Installation&quot;,&quot;hid&quot;:&quot;base_system_installation&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;2016-2559&quot;} -->
<h2 class="sectionedit5" id="chroot">Chroot</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> Mount filesystems:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">mount --rbind /dev/ /mnt/void/dev/</span>
<span class="cli_prompt"># </span><span class="cli_command">mount --rbind /sys/ /mnt/void/sys/</span>
<span class="cli_prompt"># </span><span class="cli_command">mount --rbind /proc/ /mnt/void/proc/</span>
<span class="cli_prompt"># </span><span class="cli_command">mount --rbind /run/ /mnt/void/run/</span>
<span class="cli_prompt"># </span><span class="cli_command">mount --make-rslave /mnt/void/dev/</span>
<span class="cli_prompt"># </span><span class="cli_command">mount --make-rslave /mnt/void/sys/</span>
<span class="cli_prompt"># </span><span class="cli_command">mount --make-rslave /mnt/void/proc/</span>
<span class="cli_prompt"># </span><span class="cli_command">mount --make-rslave /mnt/void/run/</span></pre><p></div>
</li>
<li class="level1"><div class="li"> Copy <abbr title="Domain Name System">DNS</abbr> configuration:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">cp /etc/resolv.conf /mnt/void/etc/</span></pre><p></div>
</li>
<li class="level1"><div class="li"> Chroot into the new installation:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">chroot /mnt/void/ /bin/sh</span>
<span class="cli_prompt"># </span><span class="cli_command">. ./etc/profile</span>
<span class="cli_prompt"># </span><span class="cli_command">export PS1=&#039;(chroot) # &#039;</span></pre><p></div>
</li>
</ol>
<hr />

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Chroot&quot;,&quot;hid&quot;:&quot;chroot&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;2560-3120&quot;} -->
<h2 class="sectionedit6" id="full_system_installation">Full System Installation</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> Install additional void subrepositories<sup><a href="#fn__1" id="fnt__1" class="fn_top">1)</a></sup> and synchronize them:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">xbps-install void-repo-nonfree void-repo-multilib void-repo-multilib-nonfree</span>
<span class="cli_prompt"># </span><span class="cli_command">xbps-install -Su xbps &amp;&amp; xbps-install -Su</span></pre><p></div>
</li>
<li class="level1"><div class="li"> Partitioning tools:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">xbps-install parted cryptsetup dosfstools e2fsprogs btrfs-progs</span></pre><p></div>
</li>
<li class="level1"><div class="li"> System tools:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">xpbs-install kbd kmod eudev acpid ncurses less</span></pre><p></div>
</li>
<li class="level1"><div class="li"> Administration tools:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">xbps-install mdocml man-pages neovim git file tree ncdu psmisc htop btop neofetch inxi opendoas</span></pre><p></div>
</li>
<li class="level1"><div class="li"> Shell tools:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">xbps-install zsh zsh-autosuggestions zsh-completions zsh-syntax-highlighting</span></pre><p></div>
</li>
<li class="level1"><div class="li"> Boot tools:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">xbps-install efibootmgr grub-x86_64-efi mkinitcpio-encrypt linux linux-lts</span></pre><p></div>
</li>
<li class="level1 node"><div class="li"> Network tools:</div>
<ol>
<li class="level2"><div class="li"> Basic:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">xbps-install iproute2 iputils dhcpcd unbound nftables mtr nmap</span></pre><p></div>
</li>
<li class="level2"><div class="li"> Ethernet:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">xbps-install ethtool</span></pre><p></div>
</li>
<li class="level2"><div class="li"> Wi-Fi:</p><pre class='cli  '><span class="cli_prompt"># </span><span class="cli_command">xbps-install wpa_supplicant iw [wifi-firmware] aircrack-ng</span></pre><p></div>
</li>
</ol>
</li>
</ol>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Full System Installation&quot;,&quot;hid&quot;:&quot;full_system_installation&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;3121-4233&quot;} -->
<h2 class="sectionedit7" id="swap_file">Swap File</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> Allocate space on COW filesystem (such as btrfs):</p><pre class='cli  '><span class="cli_prompt">(chroot) # </span><span class="cli_command">truncate -s 0 /swap</span>
<span class="cli_prompt">(chroot) # </span><span class="cli_command">chattr +C /swap</span>
<span class="cli_prompt">(chroot) # </span><span class="cli_command">fallocate -l 4G /swap</span>
<span class="cli_prompt">(chroot) # </span><span class="cli_command">chmod 0600 /swap</span></pre><p></div>
</li>
<li class="level1"><div class="li"> Set file as swap area:</p><pre class='cli  '><span class="cli_prompt">(chroot) # </span><span class="cli_command">mkswap /swap</span>
<span class="cli_prompt">(chroot) # </span><span class="cli_command">swapon /swap</span></pre><p></div>
</li>
</ol>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Swap File&quot;,&quot;hid&quot;:&quot;swap_file&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;4234-4529&quot;} -->
<h2 class="sectionedit8" id="system_configuration">System Configuration</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;System Configuration&quot;,&quot;hid&quot;:&quot;system_configuration&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:8,&quot;range&quot;:&quot;4530-4563&quot;} -->
<h2 class="sectionedit9" id="finishing">Finishing</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Finishing&quot;,&quot;hid&quot;:&quot;finishing&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:9,&quot;range&quot;:&quot;4564-&quot;} --><div class="footnotes">
<div class="fn"><sup><a href="#fnt__1" id="fn__1" class="fn_bot">1)</a></sup> 
<div class="content">Void subrepositories: <a href="https://docs.voidlinux.org/xbps/repositories/index.html#subrepositories" class="urlextern" title="https://docs.voidlinux.org/xbps/repositories/index.html#subrepositories">https://docs.voidlinux.org/xbps/repositories/index.html#subrepositories</a>.</div></div>
</div>
